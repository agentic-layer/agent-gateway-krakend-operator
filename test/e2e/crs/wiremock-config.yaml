apiVersion: v1
kind: Pod
metadata:
  name: wiremock-config
spec:
  restartPolicy: Never
  containers:
  - name: curl
    image: curlimages/curl:latest
    command: ["/bin/sh", "-c"]
    args:
    - |
      curl -X POST 'http://mocked-agent:8080/__admin/mappings' \
      -H 'Content-Type: application/json' \
      -d '{
        "request": {
          "method": "POST"
        },
        "response": {
          "status": 200,
          "body": "This is a mocked response!",
          "headers": {
            "Content-Type": "text/plain"
          }
        }
      }'
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop: ["ALL"]
      runAsNonRoot: true
      runAsUser: 1000
      seccompProfile:
        type: RuntimeDefault